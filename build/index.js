(()=>{"use strict";const e=window.wp.hooks,t=window.wp.compose,o=window.wp.blockEditor,n=window.wp.components,r=window.ReactJSXRuntime,a=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:a,setAttributes:l,name:i}=t;return"yt-for-wp/simple-youtube-feed"===i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e,{...t}),(0,r.jsx)(o.InspectorControls,{children:(0,r.jsxs)(n.PanelBody,{title:"Pro Features",children:[(0,r.jsx)(n.TextControl,{label:"YouTube Channel ID (Pro)",value:a.channelId,onChange:e=>l({channelId:e}),help:"Leave blank to use the default Channel ID from settings."}),(0,r.jsx)(n.ToggleControl,{label:"Enable User Search (Pro)",checked:a.enableSearch,onChange:e=>l({enableSearch:e})}),(0,r.jsx)(n.ToggleControl,{label:"Enable Playlist Filter (Pro)",checked:a.enablePlaylistFilter,onChange:e=>l({enablePlaylistFilter:e})})]})})]}):(0,r.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/simple-youtube-feed"===t&&(e.attributes={...e.attributes,enableSearch:{type:"boolean",default:!1},enablePlaylistFilter:{type:"boolean",default:!1},channelId:{type:"string",default:""}},void 0!==wp.blockEditor&&wp.blockEditor.useBlockProps&&(e.attributes.playlists={type:"array",default:[{id:"",snippet:{title:"All Videos"}},{id:"mock1",snippet:{title:"Mock Playlist 1"}},{id:"mock2",snippet:{title:"Mock Playlist 2"}}]})),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",a);const l={};(0,e.addAction)("yt_for_wp_simple_feed_view","yt-for-wp-pro",(async(e,t)=>{const{channelId:o,layout:n,maxVideos:r,enableSearch:a="true"===e.dataset.enableSearch,enablePlaylistFilter:i="true"===e.dataset.enablePlaylistFilter}=t,s=YT_FOR_WP.renderVideos||function(){console.error("renderVideos function is not available.")},c=YT_FOR_WP.fetchVideos||async function(){return console.error("fetchVideos function is not available."),[]},d=YT_FOR_WP.apiKey,u=o||YT_FOR_WP.channelId;let p=[],h=null,y={};try{if(e.getAttribute("data-initialized"))return void console.log(`Container #${e.id} already initialized.`);if(e.setAttribute("data-initialized","true"),await async function(e=!1){if(y[u]&&!e)return y[u];let t=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&channelId=${u}&key=${d}&maxResults=50`;h&&e&&(t+=`&pageToken=${h}`);try{const o=await fetch(t),n=await o.json();if(n.error)return void console.error("YouTube API Error:",n.error);p=e?[...p,...n.items]:[{id:"",snippet:{title:"All Videos"}},...n.items],h=n.nextPageToken||null,y[u]=p}catch(e){console.error("Error fetching playlists:",e)}}(),function(){if(e.querySelector(".youtube-search-container"))return;const t=document.createElement("div");if(t.classList.add("youtube-search-container"),i&&p.length>0){const a=document.createElement("select");a.classList.add("youtube-playlist-dropdown"),p.forEach((({id:e,snippet:t})=>{const o=document.createElement("option");o.value=e,o.textContent=t.title,a.appendChild(o)})),a.addEventListener("change",(async()=>{try{const t=a.value,i=e.querySelector(".youtube-search-bar")?.value.trim()||"",d=`${e.id}-${o}-${r}-${i}-${t}`;delete l[d];const u=await c(e,i,t);s(e,u,n)}catch(e){console.error("Error handling playlist dropdown change:",e)}})),t.appendChild(a)}if(a){const a=document.createElement("input");a.type="text",a.placeholder="Search videos",a.classList.add("youtube-search-bar");const i=document.createElement("button");i.textContent="Search",i.classList.add("youtube-search-button"),a.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),i.click())})),i.addEventListener("click",(async()=>{try{const t=a.value.trim(),i=e.querySelector(".youtube-playlist-dropdown")?.value||"",d=`${e.id}-${o}-${r}-${t}-${i}`;delete l[d];const u=await c(e,t,i);s(e,u,n)}catch(e){console.error("Error handling search button click:",e)}})),t.appendChild(a),t.appendChild(i)}t.children.length>0&&e.prepend(t)}(),!i){const t=await c(e);s(e,t,n)}}catch(e){console.error("Error during initialization:",e)}}));const i=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:a,setAttributes:l,name:i}=t;return"yt-for-wp/youtube-live"===i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e,{...t}),(0,r.jsx)(o.InspectorControls,{children:(0,r.jsx)(n.PanelBody,{title:"Pro Features",children:(0,r.jsx)(n.TextControl,{label:"YouTube Channel ID (Pro)",value:a.channelId,onChange:e=>l({channelId:e}),help:"Leave blank to use the default Channel ID from settings."})})})]}):(0,r.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/youtube-live"===t&&(e.attributes={...e.attributes,channelId:{type:"string",default:""}}),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",i),(0,e.addAction)("yt_for_wp_youtube_live_view","yt-for-wp-pro",((e,t)=>{const{channelId:o}=t;o&&(e.dataset.channelId=o)}))})();