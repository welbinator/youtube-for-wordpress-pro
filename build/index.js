(()=>{"use strict";const e=window.wp.hooks,t=window.wp.compose,n=window.wp.blockEditor,o=window.wp.components,r=window.ReactJSXRuntime,a=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:a,setAttributes:l,name:s}=t;return"yt-for-wp/simple-youtube-feed"===s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e,{...t}),(0,r.jsx)(n.InspectorControls,{children:(0,r.jsxs)(o.PanelBody,{title:"Pro Features",children:[(0,r.jsx)(o.TextControl,{label:"YouTube Channel ID (Pro)",value:a.channelId,onChange:e=>l({channelId:e}),help:"Leave blank to use the default Channel ID from settings."}),(0,r.jsx)(o.ToggleControl,{label:"Enable User Search (Pro)",checked:a.enableSearch,onChange:e=>l({enableSearch:e})}),(0,r.jsx)(o.ToggleControl,{label:"Enable Playlist Filter (Pro)",checked:a.enablePlaylistFilter,onChange:e=>l({enablePlaylistFilter:e})})]})})]}):(0,r.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/simple-youtube-feed"===t&&(e.attributes={...e.attributes,enableSearch:{type:"boolean",default:!1},enablePlaylistFilter:{type:"boolean",default:!1},channelId:{type:"string",default:""}}),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",a),(0,e.addAction)("yt_for_wp_simple_feed_view","yt-for-wp-pro",(async(e,t)=>{const{channelId:n,layout:o,maxVideos:r,enableSearch:a="true"===e.dataset.enableSearch,enablePlaylistFilter:l="true"===e.dataset.enablePlaylistFilter}=t;console.log("Pro Attributes:",{enableSearch:a,enablePlaylistFilter:l});const s=YT_FOR_WP.renderVideos,i=YT_FOR_WP.fetchVideos,c=YT_FOR_WP.apiKey,d=n||YT_FOR_WP.channelId;let u=[],p=null;await async function(e=!1){let t=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&channelId=${d}&key=${c}&maxResults=50`;p&&e&&(t+=`&pageToken=${p}`);try{const n=await fetch(t),o=await n.json();if(o.error)return void console.error("YouTube API Error:",o.error);u=e?[...u,...o.items]:[{id:"",snippet:{title:"All Videos"}},...o.items],p=o.nextPageToken||null}catch(e){console.error("Error fetching playlists:",e)}}(),function(){if(e.querySelector(".youtube-search-container"))return;const t=document.createElement("div");if(t.classList.add("youtube-search-container"),l&&u.length>0){const n=document.createElement("select");n.classList.add("youtube-playlist-dropdown"),u.forEach((({id:e,snippet:t})=>{const o=document.createElement("option");o.value=e,o.textContent=t.title,n.appendChild(o)})),n.addEventListener("change",(async()=>{const t=n.value,r=e.querySelector(".youtube-search-bar")?.value.trim()||"",a=await i(e,r,t);s(e,a,o)})),t.appendChild(n)}if(a){const n=document.createElement("input");n.type="text",n.placeholder="Search videos",n.classList.add("youtube-search-bar");const r=document.createElement("button");r.textContent="Search",r.classList.add("youtube-search-button"),n.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),r.click())})),r.addEventListener("click",(async()=>{const t=n.value.trim(),r=e.querySelector(".youtube-playlist-dropdown")?.value||"",a=await i(e,t,r);s(e,a,o)})),t.appendChild(n),t.appendChild(r)}t.children.length>0&&e.prepend(t)}();const h=await i(e);s(e,h,o)}));const l=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:a,setAttributes:l,name:s}=t;return"yt-for-wp/youtube-live"===s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e,{...t}),(0,r.jsx)(n.InspectorControls,{children:(0,r.jsx)(o.PanelBody,{title:"Pro Features",children:(0,r.jsx)(o.TextControl,{label:"YouTube Channel ID (Pro)",value:a.channelId,onChange:e=>l({channelId:e}),help:"Leave blank to use the default Channel ID from settings."})})})]}):(0,r.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/youtube-live"===t&&(e.attributes={...e.attributes,channelId:{type:"string",default:""}}),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",l),(0,e.addAction)("yt_for_wp_youtube_live_view","yt-for-wp-pro",((e,t)=>{const{channelId:n}=t;n&&(e.dataset.channelId=n)}))})();