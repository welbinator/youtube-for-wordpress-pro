(()=>{"use strict";const e=window.wp.hooks,t=window.wp.compose,o=window.wp.blockEditor,n=window.wp.components,l=window.ReactJSXRuntime,r=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:r,setAttributes:a,name:s}=t;if("yt-for-wp/simple-youtube-feed"===s){const{contentTypes:s={standard:!0,short:!0,live:!0}}=r;return console.log("Current Attributes in Editor:",r),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e,{...t}),(0,l.jsx)(o.InspectorControls,{children:(0,l.jsxs)(n.PanelBody,{title:"Pro Features",children:[(0,l.jsx)(n.TextControl,{label:"YouTube Channel ID (Pro)",value:r.channelId,onChange:e=>{a({channelId:e}),console.log("Channel ID Updated:",e)},help:"Leave blank to use the default Channel ID from settings."}),(0,l.jsx)(n.ToggleControl,{label:"Enable User Search (Pro)",checked:r.enableSearch,onChange:e=>{a({enableSearch:e}),console.log("Enable Search Updated:",e)}}),(0,l.jsx)(n.ToggleControl,{label:"Enable Playlist Filter (Pro)",checked:r.enablePlaylistFilter,onChange:e=>{a({enablePlaylistFilter:e}),console.log("Enable Playlist Filter Updated:",e)}}),(0,l.jsxs)(n.PanelBody,{title:"Content Types",children:[(0,l.jsx)(n.ToggleControl,{label:"Standard",checked:s.standard,onChange:e=>{const t={...s,standard:e};a({contentTypes:t}),console.log("Content Types Updated:",t)}}),(0,l.jsx)(n.ToggleControl,{label:"Short",checked:s.short,onChange:e=>{const t={...s,short:e};a({contentTypes:t}),console.log("Content Types Updated:",t)}}),(0,l.jsx)(n.ToggleControl,{label:"Live",checked:s.live,onChange:e=>{const t={...s,live:e};a({contentTypes:t}),console.log("Content Types Updated:",t)}})]})]})})]})}return(0,l.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/simple-youtube-feed"===t&&(e.attributes={...e.attributes,enableSearch:{type:"boolean",default:!1},enablePlaylistFilter:{type:"boolean",default:!1},channelId:{type:"string",default:""},contentTypes:{type:"object",default:{standard:!0,short:!0,live:!0}}},console.log("Pro Attributes Added:",e.attributes)),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",r),(0,e.addAction)("yt_for_wp_simple_feed_view","yt-for-wp-pro",(async(e,t)=>{const{channelId:o,layout:n,maxVideos:l,enableSearch:r="true"===e.dataset.enableSearch,enablePlaylistFilter:a="true"===e.dataset.enablePlaylistFilter,contentTypes:s=JSON.parse(e.dataset.contentTypes||'["standard", "short", "live"]')}=t;if(console.log("Pro Attributes:",{channelId:o,layout:n,maxVideos:l,enableSearch:r,enablePlaylistFilter:a,contentTypes:s}),"true"===e.dataset.initialized)return void console.log(`Container ${e.id} already initialized. Skipping.`);e.dataset.initialized="true";const i=YT_FOR_WP.renderVideos||function(){console.error("renderVideos function is not available.")},c=YT_FOR_WP.fetchVideos||async function(){return console.error("fetchVideos function is not available."),[]};let d=[],p=null;function u(e){console.log("Filtering Videos by Type:",s);const t=e.filter((e=>{const t=function(e){return"live"===e.snippet.liveBroadcastContent?"live":"22"===e.snippet.categoryId?"short":"standard"}(e);return console.log("Video Type:",t,"Included:",s.includes(t)),s.includes(t)}));return console.log("Filtered Videos:",t),t}try{console.log("Initializing playlists and videos..."),await async function(e=!1){const t=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&channelId=${o}&key=${YT_FOR_WP.apiKey}&maxResults=50`;console.log("Fetching playlists from API:",t);try{const o=await fetch(t),n=await o.json();if(n.error)return void console.error("YouTube API Error:",n.error);d=e?[...d,...n.items]:[{id:"",snippet:{title:"All Videos"}},...n.items],p=n.nextPageToken||null,console.log("Fetched Playlists:",d)}catch(e){console.error("Error fetching playlists:",e)}}(),function(){if(console.log("Rendering Search and Filter UI..."),e.querySelector(".youtube-search-container"))return void console.log("Search and Filter UI already exists, skipping...");const t=document.createElement("div");if(t.classList.add("youtube-search-container"),a&&d.length>0){console.log("Rendering Playlist Filter Dropdown...");const o=document.createElement("select");o.classList.add("youtube-playlist-dropdown"),d.forEach((({id:e,snippet:t})=>{const n=document.createElement("option");n.value=e,n.textContent=t.title,o.appendChild(n)})),o.addEventListener("change",(async()=>{console.log("Playlist dropdown changed.");const t=o.value,l=e.querySelector(".youtube-search-bar")?.value.trim()||"",r=u(await c(e,l,t));i(e,r,n)})),t.appendChild(o)}if(r){console.log("Rendering Search Bar...");const o=document.createElement("input");o.type="text",o.placeholder="Search videos",o.classList.add("youtube-search-bar");const l=document.createElement("button");l.textContent="Search",l.classList.add("youtube-search-button"),o.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.preventDefault(),l.click())})),l.addEventListener("click",(async()=>{console.log("Search button clicked.");const t=o.value.trim(),l=e.querySelector(".youtube-playlist-dropdown")?.value||"",r=u(await c(e,t,l));i(e,r,n)})),t.appendChild(o),t.appendChild(l)}t.children.length>0&&(console.log("Appending Search and Filter UI..."),e.prepend(t))}();const t=u(await c(e));i(e,t,n)}catch(e){console.error("Error during initialization:",e)}}));const a=(0,t.createHigherOrderComponent)((e=>t=>{const{attributes:r,setAttributes:a,name:s}=t;return"yt-for-wp/youtube-live"===s?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e,{...t}),(0,l.jsx)(o.InspectorControls,{children:(0,l.jsx)(n.PanelBody,{title:"Pro Features",children:(0,l.jsx)(n.TextControl,{label:"YouTube Channel ID (Pro)",value:r.channelId,onChange:e=>a({channelId:e}),help:"Leave blank to use the default Channel ID from settings."})})})]}):(0,l.jsx)(e,{...t})}),"withProControls");(0,e.addFilter)("blocks.registerBlockType","yt-for-wp-pro/add-pro-attributes",((e,t)=>("yt-for-wp/youtube-live"===t&&(e.attributes={...e.attributes,channelId:{type:"string",default:""}}),e))),(0,e.addFilter)("editor.BlockEdit","yt-for-wp-pro/add-pro-controls",a),(0,e.addAction)("yt_for_wp_youtube_live_view","yt-for-wp-pro",((e,t)=>{const{channelId:o}=t;o&&(e.dataset.channelId=o)}))})();